<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Home Alarm</title>
    <style>
        body {
            padding: 20px;
        }

        h1 {
            font-size: 80px;
        }

        p {
            font-size: 46px;
        }

        button {
            font-size: 56px;
        }
    </style>

    <script type="text/javascript">
        var lastUIResponse;

        refreshPageState();

        function sendUIWebRequest(request, callback) {
            var xmlHttp = new XMLHttpRequest();

            xmlHttp.onreadystatechange = function () {
                if (xmlHttp.readyState == 4) {
                    if (xmlHttp.status == 200) {
                        var response = JSON.parse(xmlHttp.responseText);
                        lastUIResponse = response;
                        updatePageState(response);

                        if (callback)
                            callback(response);
                    } else {
                        alert(xmlHttp.statusText)
                    }
                }
            }

            xmlHttp.open("POST", "/", true); // true for asynchronous 
            xmlHttp.send(JSON.stringify(request));
        }

        function refreshPageState() {
            sendUIWebRequest({}, null);
        }

        function toggleAlarmOn() {
            var request = {
                alarmOn:false
            };

            if (lastUIResponse) {
                request.alarmOn = !lastUIResponse.alarmOn;
            }

            sendUIWebRequest(request, null);
        }

        function updatePageState(response) {
            document.getElementById("toggleAlarmButton").innerHTML = response.alarmOn ? "Turn Off" : "Turn On";
            document.getElementById("sector0Par").innerHTML = "sector0   " + response.sector0BoolValue;
        }
    </script>
</head>

<body>
    <h1>Home Alarm</h1>
    <p id="sector0Par">-</p>
    <button onclick="toggleAlarmOn()" id="toggleAlarmButton">-</button>
</body>

</html>